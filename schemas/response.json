
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "JurisBinderResponse",
  "type": "object",
  "required": [
    "intent",
    "operations",
    "assistant_notes",
    "compliance"
  ],
  "additionalProperties": false,
  "properties": {
    "intent": {
      "type": "string",
      "enum": [
        "CASE_CREATE",
        "DOC_INGEST",
        "DOC_CLASSIFY",
        "DOC_RENAME",
        "DOC_LINK_CREATE",
        "ARTIFACT_CREATE",
        "DOC_STATUS_TRANSITION",
        "TRACE_APPEND",
        "ORIGINAL_REGISTER",
        "DEDUPE_CHECK",
        "EXPORT_PACK",
        "QUERY_STATUS",
        "ERROR"
      ]
    },
    "operations": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "op_type",
          "payload"
        ],
        "additionalProperties": false,
        "properties": {
          "op_type": {
            "type": "string",
            "enum": [
              "TOOL_CALL",
              "RETURN_DATA"
            ]
          },
          "payload": {
            "type": "object",
            "description": "The arguments for the tool call or the data being returned."
          }
        }
      }
    },
    "data": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "case": {
          "type": "object",
          "required": [
            "case_id",
            "case_title",
            "jurisdiction",
            "created_at",
            "branches",
            "confidentiality_level"
          ],
          "additionalProperties": false,
          "properties": {
            "case_id": { "type": "string", "minLength": 6, "maxLength": 64 },
            "case_title": { "type": "string", "minLength": 3, "maxLength": 200 },
            "jurisdiction": { "type": "string", "minLength": 2, "maxLength": 120 },
            "created_at": { "type": "string" },
            "confidentiality_level": {
              "type": "string",
              "enum": [ "PUBLIC", "NORMAL", "SENSITIVE", "HEALTH", "CRIMINAL", "LEGAL_PRIVILEGED" ]
            },
            "parties": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [ "party_role", "display_label" ],
                "additionalProperties": false,
                "properties": {
                  "party_role": { "type": "string", "enum": [ "SELF", "COUNTERPARTY", "AUTHORITY", "COURT", "DOCTOR", "EXPERT", "OTHER" ] },
                  "display_label": { "type": "string", "maxLength": 160 },
                  "notes": { "type": "string", "maxLength": 2000 }
                }
              }
            },
            "branches": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "required": [ "branch_id", "branch_code", "branch_label", "isolation_level" ],
                "additionalProperties": false,
                "properties": {
                  "branch_id": { "type": "string", "minLength": 6, "maxLength": 64 },
                  "branch_code": { "type": "string", "enum": [ "ADMIN", "FACT", "PEN", "CIV", "ADM", "MED", "EXP", "COR", "EVD", "ANA", "STR", "PRC", "ARC" ] },
                  "branch_label": { "type": "string", "maxLength": 120 },
                  "isolation_level": { "type": "string", "enum": [ "STRICT", "STRICT_WITH_REFERENCES" ] },
                  "default_storage_ref": { "type": "string", "maxLength": 500 }
                }
              }
            },
            "root_storage_ref": { "type": "string", "maxLength": 500 },
            "tags": { "type": "array", "items": { "type": "string", "maxLength": 40 } }
          }
        },
        "document": {
          "type": "object",
          "required": [ "document_id", "case_id", "branch_code", "doc_type_code", "status", "source_channel", "confidentiality_level", "registered_at", "artifacts" ],
          "additionalProperties": false,
          "properties": {
            "document_id": { "type": "string", "minLength": 6, "maxLength": 128 },
            "case_id": { "type": "string", "minLength": 6, "maxLength": 64 },
            "branch_code": { "type": "string", "enum": [ "ADMIN", "FACT", "PEN", "CIV", "ADM", "MED", "EXP", "COR", "EVD", "ANA", "STR", "PRC", "ARC" ] },
            "doc_type_code": { "type": "string", "enum": [ "LETTER_IN", "LETTER_OUT", "EMAIL", "EMAIL_ATTACHMENT", "FAX", "COURT_ORDER", "COURT_JUDGMENT", "DECISION", "RULING", "SUMMONS", "FILING", "COMPLAINT", "STATEMENT", "BRIEF", "MOTION", "APPEAL", "PROTOCOL_MINUTES", "HEARING_NOTE", "EVIDENCE_ITEM", "PHOTO", "VIDEO", "AUDIO", "MED_REPORT", "MED_CERTIFICATE", "MED_LAB_RESULT", "MED_IMAGING_REPORT", "MED_CORRESPONDENCE", "EXPERT_REPORT", "EXPERT_ANNEX", "INVOICE", "RECEIPT", "CONTRACT", "POLICY", "FORM", "ID_DOCUMENT", "CHRONOLOGY", "SYNTHESIS", "INTERNAL_NOTE", "OTHER" ] },
            "status": { "type": "string", "enum": [ "INBOX", "REGISTERED", "CLASSIFIED", "QUALIFIED", "EXHIBIT_READY", "FILED", "FROZEN", "ARCHIVED", "DUPLICATE", "DISPUTED", "REDACTED", "ERROR" ] },
            "source_channel": { "type": "string", "enum": [ "SCAN", "POST", "EMAIL", "PORTAL", "HAND_DELIVERED", "MESSAGING_APP", "PHONE_RECORDING", "PHOTO_CAPTURE", "SYSTEM_EXPORT", "OTHER" ] },
            "confidentiality_level": { "type": "string", "enum": [ "PUBLIC", "NORMAL", "SENSITIVE", "HEALTH", "CRIMINAL", "LEGAL_PRIVILEGED" ] },
            "doc_date": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
            "author": { "type": "string", "maxLength": 160 },
            "counterparty": { "type": "string", "maxLength": 160 },
            "subject": { "type": "string", "maxLength": 240 },
            "registered_at": { "type": "string" },
            "registered_by": { "type": "string", "maxLength": 120 },
            "physical_original_id": { "type": "string", "maxLength": 128 },
            "exhibits": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [ "branch_code", "exhibit_id" ],
                "additionalProperties": false,
                "properties": {
                  "branch_code": { "type": "string" },
                  "exhibit_id": { "type": "string", "maxLength": 40 },
                  "filed_at": { "type": "string" }
                }
              }
            },
            "artifacts": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "required": [ "artifact_id", "document_id", "artifact_type", "storage_ref", "filename", "mime_type", "sha256", "created_at" ],
                "additionalProperties": false,
                "properties": {
                  "artifact_id": { "type": "string", "minLength": 6, "maxLength": 128 },
                  "document_id": { "type": "string", "minLength": 6, "maxLength": 128 },
                  "artifact_type": { "type": "string", "enum": [ "SOURCE", "OCR_TEXT", "REDACTED_FILE", "ANNOTATED_FILE", "TRANSLATION", "THUMBNAIL", "EXPORT_BUNDLE", "OTHER" ] },
                  "storage_ref": { "type": "string", "maxLength": 800 },
                  "filename": { "type": "string", "maxLength": 260 },
                  "mime_type": { "type": "string", "maxLength": 120 },
                  "sha256": { "type": "string", "pattern": "^[A-Fa-f0-9]{64}$" },
                  "byte_size": { "type": "integer", "minimum": 0 },
                  "created_at": { "type": "string" },
                  "provenance": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "derived_from_artifact_id": { "type": "string" },
                      "derivation_method": { "type": "string", "enum": [ "OCR", "REDACTION", "ANNOTATION", "TRANSLATION", "CONVERSION", "BUNDLE_EXPORT", "OTHER" ] },
                      "tool_version": { "type": "string", "maxLength": 80 },
                      "notes": { "type": "string", "maxLength": 2000 }
                    }
                  }
                }
              }
            },
            "quality_flags": {
              "type": "array",
              "items": { "type": "string", "enum": [ "PAGES_MISSING", "LOW_SCAN_QUALITY", "UNCERTAIN_DATE", "UNCERTAIN_AUTHOR", "POTENTIAL_DUPLICATE", "SIGNATURE_PRESENT", "STAMP_PRESENT", "HANDWRITTEN_NOTES" ] }
            },
            "notes": { "type": "string", "maxLength": 4000 }
          }
        },
        "physical_original": {
          "type": "object",
          "required": [ "physical_original_id", "case_id", "label", "location", "registered_at", "custody_chain" ],
          "additionalProperties": false,
          "properties": {
            "physical_original_id": { "type": "string", "minLength": 6, "maxLength": 128 },
            "case_id": { "type": "string", "minLength": 6, "maxLength": 64 },
            "label": { "type": "string", "maxLength": 160 },
            "location": {
              "type": "object",
              "required": [ "binder", "section" ],
              "additionalProperties": false,
              "properties": {
                "binder": { "type": "string", "maxLength": 80 },
                "section": { "type": "string", "maxLength": 80 },
                "pocket": { "type": "string", "maxLength": 80 },
                "page_range": { "type": "string", "maxLength": 40 }
              }
            },
            "registered_at": { "type": "string" },
            "custody_chain": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "required": [ "timestamp", "actor", "action" ],
                "additionalProperties": false,
                "properties": {
                  "timestamp": { "type": "string" },
                  "actor": { "type": "string", "maxLength": 120 },
                  "action": { "type": "string", "enum": [ "CREATED", "TRANSFERRED", "VIEWED", "RETURNED", "LOST", "DESTROYED", "OTHER" ] },
                  "notes": { "type": "string", "maxLength": 2000 }
                }
              }
            }
          }
        },
        "link": {
          "type": "object",
          "required": [ "link_id", "case_id", "link_type", "from_object", "to_object", "justification", "created_at" ],
          "additionalProperties": false,
          "properties": {
            "link_id": { "type": "string", "minLength": 6, "maxLength": 128 },
            "case_id": { "type": "string", "minLength": 6, "maxLength": 64 },
            "link_type": { "type": "string", "enum": [ "CROSS_BRANCH_REFERENCE", "DERIVED_FROM", "ATTACHMENT_OF", "RELATES_TO_SAME_EVENT", "SUPERSEDES", "TRANSLATION_OF", "REDACTION_OF", "OCR_OF" ] },
            "from_object": {
              "type": "object",
              "required": [ "object_type", "object_id" ],
              "additionalProperties": false,
              "properties": {
                "object_type": { "type": "string", "enum": [ "DOCUMENT", "ARTIFACT", "PHYSICAL_ORIGINAL", "CASE", "OTHER" ] },
                "object_id": { "type": "string", "minLength": 6, "maxLength": 128 },
                "branch_code": { "type": "string" }
              }
            },
            "to_object": {
              "type": "object",
              "required": [ "object_type", "object_id" ],
              "additionalProperties": false,
              "properties": {
                "object_type": { "type": "string", "enum": [ "DOCUMENT", "ARTIFACT", "PHYSICAL_ORIGINAL", "CASE", "OTHER" ] },
                "object_id": { "type": "string", "minLength": 6, "maxLength": 128 },
                "branch_code": { "type": "string" }
              }
            },
            "justification": { "type": "string", "minLength": 3, "maxLength": 1200 },
            "created_at": { "type": "string" },
            "created_by": { "type": "string", "maxLength": 120 }
          }
        },
        "trace_event": {
          "type": "object",
          "required": [ "event_id", "case_id", "timestamp", "actor", "event_type", "objects", "details" ],
          "additionalProperties": false,
          "properties": {
            "event_id": { "type": "string", "minLength": 6, "maxLength": 128 },
            "case_id": { "type": "string", "minLength": 6, "maxLength": 64 },
            "timestamp": { "type": "string" },
            "actor": { "type": "string", "maxLength": 120 },
            "event_type": { "type": "string", "enum": [ "CASE_CREATED", "BRANCH_CREATED", "DOC_INGESTED", "DOC_CLASSIFIED", "DOC_QUALIFIED", "DOC_RENAMED", "DOC_STATUS_CHANGED", "DOC_LINKED", "ARTIFACT_CREATED", "OCR_PERFORMED", "REDACTION_PERFORMED", "PHYSICAL_ORIGINAL_REGISTERED", "PHYSICAL_CUSTODY_CHANGED", "EXPORT_CREATED", "ERROR_RECORDED", "ESCALATED_REASONING" ] },
            "objects": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "required": [ "object_type", "object_id" ],
                "additionalProperties": false,
                "properties": {
                  "object_type": { "type": "string", "enum": [ "CASE", "BRANCH", "DOCUMENT", "ARTIFACT", "PHYSICAL_ORIGINAL", "LINK" ] },
                  "object_id": { "type": "string", "minLength": 6, "maxLength": 128 },
                  "branch_code": { "type": "string" }
                }
              }
            },
            "details": {
              "type": "object",
              "additionalProperties": true,
              "properties": {
                "summary": { "type": "string", "maxLength": 1000 },
                "before": { "type": "object" },
                "after": { "type": "object" },
                "justification": { "type": "string", "maxLength": 2000 },
                "risk_note": { "type": "string", "maxLength": 2000 },
                "think_more_trigger": { "type": "string", "enum": [ "BRANCH_CONFLICT", "MULTI_TYPE_CONFLICT", "PROCEDURAL_RISK_ON_STATUS_CHANGE", "INTERNAL_INCONSISTENCY_DETECTED", "HYBRID_MEDICO_LEGAL_DOCUMENT", "USER_REQUESTED_DEEP_VERIFICATION" ] }
              }
            }
          }
        }
      }
    },
    "assistant_notes": {
      "type": "object",
      "required": [
        "summary",
        "assumptions",
        "missing_info"
      ],
      "additionalProperties": false,
      "properties": {
        "summary": { "type": "string" },
        "assumptions": { "type": "array", "items": { "type": "string" } },
        "missing_info": { "type": "array", "items": { "type": "string" } }
      }
    },
    "compliance": {
      "type": "object",
      "required": [
        "invariants_respected",
        "trace_required",
        "branch_isolation_respected"
      ],
      "additionalProperties": false,
      "properties": {
        "invariants_respected": { "type": "boolean" },
        "trace_required": { "type": "boolean" },
        "branch_isolation_respected": { "type": "boolean" },
        "think_more_used": { "type": "boolean" },
        "think_more_trigger": { "type": "string" }
      }
    },
    "errors": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "code",
          "message"
        ],
        "additionalProperties": false,
        "properties": {
          "code": { "type": "string" },
          "message": { "type": "string" },
          "field": { "type": "string" }
        }
      }
    }
  }
}
